import {
  JupyterFrontEnd,
  JupyterFrontEndPlugin
} from '@jupyterlab/application';
import { ICommandPalette } from '@jupyterlab/apputils';
import { Widget } from '@lumino/widgets';
import { LabIcon } from '@jupyterlab/ui-components';

const myIcon = new LabIcon({
  name: 'ESS:icon',
  svgstr: `<svg version="1.1" id="ess" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
	 viewBox="0 0 219.685 212.598" style="enable-background:new 0 0 219.685 212.598;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#0099DC;}
</style>
<path class="st0" d="M22.281,54.887c6.711-17.482,20.582-31.019,39.059-38.118c18.503-7.109,39.406-6.911,58.858,0.556
	c11.778,4.521,22.075,11.29,30.604,20.117c6.548,6.777,11.814,14.632,15.45,22.996c-5.851-8.122-13.372-14.981-22.035-20.05
	c-10.903-6.378-23.38-9.75-36.083-9.75c-11.534,0-22.546,2.66-32.729,7.905c-9.715,5.004-18.297,12.301-24.818,21.103
	c-0.233,0.315-0.167,0.758,0.147,0.991c0.314,0.232,0.758,0.167,0.991-0.147c6.393-8.629,14.806-15.783,24.328-20.687
	c9.981-5.141,20.774-7.747,32.08-7.747c12.451,0,24.681,3.305,35.367,9.556c10.372,6.068,19.073,14.752,25.161,25.115
	c0.184,0.312,0.574,0.436,0.903,0.287c0.33-0.149,0.494-0.524,0.381-0.868c-3.578-10.853-9.845-21.119-18.125-29.688
	c-8.674-8.978-19.143-15.86-31.116-20.456c-19.78-7.593-41.043-7.79-59.874-0.555C41.975,22.69,27.814,36.517,20.958,54.379
	c-5.84,15.215-5.818,31.668,0.065,47.58c0.106,0.286,0.377,0.463,0.665,0.463c0.082,0,0.165-0.014,0.246-0.044
	c0.367-0.136,0.554-0.543,0.419-0.911C16.591,85.883,16.566,69.775,22.281,54.887z M151.378,176.783
	c-0.301-0.25-0.748-0.208-0.998,0.092c-10.615,12.782-24.552,20.857-40.304,23.352c-18.495,2.929-37.154-2.315-52.54-14.768
	c-15.408-12.47-25.688-30.671-28.948-51.25c-1.974-12.46-1.26-24.762,2.12-36.562c2.595-9.059,6.765-17.547,12.189-24.878
	c-4.109,9.128-6.288,19.071-6.346,29.108C36.479,114.508,39.798,127,46.149,138c5.767,9.989,13.576,18.195,23.21,24.392
	c9.191,5.911,19.801,9.695,30.685,10.941c0.389,0.045,0.74-0.234,0.785-0.623c0.044-0.388-0.235-0.74-0.623-0.785
	c-10.67-1.222-21.071-4.931-30.08-10.725c-9.443-6.073-17.096-14.117-22.75-23.909c-6.225-10.783-9.479-23.026-9.408-35.407
	c0.069-12.016,3.24-23.894,9.169-34.348c0.179-0.315,0.091-0.715-0.203-0.925c-0.294-0.211-0.701-0.166-0.942,0.104
	c-7.61,8.525-13.367,19.086-16.648,30.541c-3.438,12.001-4.164,24.508-2.157,37.175c3.314,20.926,13.775,39.439,29.456,52.13
	c15.702,12.709,34.757,18.059,53.654,15.066c16.097-2.55,30.334-10.796,41.173-23.846c0.195-0.235,0.213-0.558,0.068-0.807
	C151.498,176.903,151.444,176.838,151.378,176.783z M193.149,50.633c-10.256-12.665-24.516-20.872-41.238-23.734
	c-0.301-0.051-0.59,0.095-0.733,0.344c-0.041,0.071-0.07,0.15-0.085,0.235c-0.066,0.386,0.193,0.752,0.579,0.818
	c16.377,2.802,30.339,10.834,40.376,23.228c11.785,14.553,16.572,33.334,13.481,52.885c-3.095,19.579-13.718,37.582-29.91,50.695
	c-9.804,7.939-20.814,13.472-32.724,16.445c-9.143,2.282-18.579,2.915-27.64,1.883c9.96-1.006,19.66-4.09,28.381-9.058
	c10.975-6.253,20.134-15.373,26.485-26.374c5.767-9.989,8.97-20.855,9.519-32.297c0.524-10.915-1.505-21.996-5.867-32.045
	c-0.156-0.359-0.573-0.524-0.932-0.368c-0.358,0.156-0.523,0.573-0.368,0.932c4.276,9.851,6.265,20.714,5.752,31.413
	c-0.538,11.214-3.678,21.865-9.331,31.656c-6.226,10.783-15.202,19.722-25.959,25.851c-10.441,5.948-22.312,9.141-34.331,9.233
	c-0.362,0.003-0.665,0.279-0.7,0.639c-0.036,0.361,0.206,0.69,0.561,0.764c11.188,2.328,23.212,2.033,34.773-0.853
	c12.112-3.023,23.307-8.648,33.273-16.719c16.465-13.333,27.268-31.65,30.418-51.575C210.083,84.678,205.19,65.502,193.149,50.633z
	 M148.915,85.511c5.314,0,8.548,2.509,9.075,6.187h11.67c-0.129-4.429-2.064-8.104-5.816-10.93
	c-3.886-2.927-8.897-4.441-15.032-4.441c-13.448,0-17.969,6.959-18.918,8.576c-0.944-1.532-5.709-8.576-18.878-8.576
	c-14.119,0-18.487,7.543-19.44,9.567c-4.207-5.386-10.77-9.567-20.511-9.567c-7.499,0-13.732,2.422-18.601,7.266
	c-4.967,4.945-7.402,11.1-7.402,18.67c0,7.569,2.435,13.724,7.402,18.568c4.869,4.844,11.101,7.266,18.601,7.266
	c12.381,0,18.47-7.031,20.204-9.035c1.023,1.661,6.227,9.035,20.36,9.035c13.017,0,17.96-6.169,18.804-7.192
	c1.072,1.264,6.366,7.192,18.992,7.192c6.442,0,11.657-1.413,15.747-4.34c3.988-2.926,6.033-6.661,6.033-11.202
	c0-9.09-7.987-12.974-17.792-14.835c-9.624-1.827-12.791-3.128-12.791-6.761C140.623,87.731,143.61,85.511,148.915,85.511z
	 M71.164,86.233c6.725,0,11.752,4.458,13.439,10.076H58.211C60.026,90.645,64.891,86.233,71.164,86.233z M111.528,118.712
	c-5.867,0-9.612-2.724-9.919-6.761H81.978c-1.475,3.342-5.273,6.241-10.814,6.241c-7.254,0-12.952-5.458-13.439-11.893H96.58
	c0.29-1.1,0.388-2.398,0.389-3.894c2.644,1.625,6.07,2.887,10.26,3.739c9.711,1.975,12.954,3.182,12.954,6.816
	C120.185,116.291,116.967,118.712,111.528,118.712z M145.026,106.145c9.711,1.975,12.954,3.182,12.954,6.816
	c0,3.33-3.217,5.752-8.656,5.752c-5.867,0-9.612-2.724-9.919-6.761h-6.012c-0.35-8.657-8.192-12.411-17.775-14.23
	c-9.625-1.827-12.791-3.128-12.791-6.761c0-3.229,2.988-5.449,8.292-5.449c5.314,0,8.548,2.509,9.075,6.187h7.967
	C128.231,98.794,133.969,103.896,145.026,106.145z"/>
</svg>`
});

const plugin: JupyterFrontEndPlugin<void> = {
  id: 'ESS:plugin',
  description: 'Add a left panel widget with some links to ESS resources.',
  autoStart: true,
  requires: [ICommandPalette],
  activate: (app: JupyterFrontEnd, palette: ICommandPalette) => {
    console.log('JupyterLab extension jupyterlab-ess is activated!')

    const widget = new Widget();
    widget.id = 'ESS-widget';
    widget.title.icon = myIcon;
    widget.title.closable = true;
    widget.node.innerHTML = `
	<div style="padding: 20px;">
		<p>To find the lock files for environments on VISA, please visit:</p>
		<a href="https://git.esss.dk/visa/visa-pixi-env/" target="_blank" style="color: #0099DC; text-decoration: underline;">
		VISA Conda Locks Files
		</a>
	</div>
	`;

    // Add the widget to the left area
    app.shell.add(widget, 'left');
  }
};

export default plugin;
